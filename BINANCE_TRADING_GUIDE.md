# 币安自动交易系统使用指南

## 功能概述

本系统实现了基于15分钟趋势过滤 + 5分钟回调进场的加密货币日内交易策略，并集成了币安期货交易功能。

## 主要功能

### 1. 策略回测（Strategy Backtest）
- 可调整的策略参数（EMA周期、RSI、止损止盈等）
- 模拟数据生成
- 完整的回测引擎
- 可视化K线图展示交易信号
- 详细的统计指标（胜率、盈亏比、最大回撤等）

### 2. 自动交易（Auto Trading）
- 币安API配置
- 实时获取合约列表
- WebSocket实时K线数据接收
- 实时策略计算和信号检测
- 自动交易执行
- 交易记录和监控

## 使用步骤

### 准备工作

1. **获取币安API Key**
   - 登录币安官网：https://www.binance.com/
   - 进入 API管理（https://www.binance.com/en/my/settings/api-management）
   - 创建新的API Key
   - **重要**：建议先在测试环境（币安测试网）中使用

2. **API权限设置**
   - 启用期货交易权限
   - 建议不要开启提币权限
   - 设置IP白名单（推荐）

### 策略回测使用

1. **进入"策略回测"标签页**
2. **调整策略参数**
   - EMA短期/长期周期（默认20/60）
   - RSI周期（默认14）
   - 止损比例（默认0.4%）
   - 止盈倍数（1R、2R）
   - 杠杆倍数（默认3x）
3. **生成模拟数据**
   - 点击"生成模拟数据"按钮
4. **运行回测**
   - 点击"运行回测"按钮
   - 查看回测结果和交易明细
   - 查看K线图上的交易信号标注

### 自动交易使用

#### 测试模式（推荐首次使用）

1. **进入"自动交易"标签页**
2. **配置API**
   - 输入API Key和API Secret
   - **勾选"测试模式"**（默认已勾选）
   - 点击"连接币安"
3. **选择监控合约**
   - 系统会自动获取USDT本位合约列表
   - 默认选择了主流币（BTC、ETH等）
   - 可以自行选择或取消选择其他合约
4. **调整策略参数**
   - 根据回测结果调整参数
5. **开始监控**
   - 点击"开始监控"按钮
   - 系统会：
     - 获取历史K线数据
     - 建立WebSocket连接接收实时数据
     - 实时计算策略信号
   - 查看交易信号和实时价格
   - **测试模式下不会真实下单**

#### 实盘交易（谨慎使用）

⚠️ **警告：实盘交易涉及真实资金，请谨慎使用！**

1. **完成充分测试**
   - 在测试模式下运行足够长时间
   - 观察策略表现
   - 确认策略符合预期
2. **进入实盘模式**
   - 取消勾选"测试模式"
   - 系统会弹出警告提示
   - 确认后可开启实盘交易
3. **开启自动交易**
   - 勾选"自动交易"
   - 系统会根据信号自动下单
4. **风险控制**
   - 建议从小仓位开始
   - 设置合理的止损
   - 定期查看交易记录
   - 可随时停止监控

## 策略逻辑详解

### 15分钟趋势过滤（趋势判断）

**多头条件：**
1. EMA20 > EMA60
2. 收盘价在EMA20之上
3. 最近3根K线未跌破EMA60
4. 当前成交量 ≥ 20均量

**空头条件：**
1. EMA20 < EMA60
2. 收盘价在EMA20之下
3. 最近3根K线未突破EMA60
4. 当前成交量 ≥ 20均量

**震荡过滤：**
- EMA20与EMA60距离 < 0.15% 视为震荡，不交易

### 进场信号

做多信号出现后，在5分钟周期寻找进场点：
1. 价格回踩EMA20或EMA60
2. 回调过程中成交量递减
3. RSI由低位回升，或出现阳线吞没
4. 收盘价重新站上EMA20后进场

做空信号逻辑反向。

### 止损止盈

**止损：**
- 设置在5分钟最近结构高/低点
- 或固定0.3%–0.6%

**止盈：**
- 1R止盈50%
- 2R–3R全部止盈
- 达到1R后止损移动到进场价

## 仓位管理建议

- 单笔风险不超过账户的1%–3%
- 建议使用3x–5x杠杆
- 仓位 = 允许亏损 ÷ 止损比例

## 安全建议

1. **API密钥安全**
   - API密钥保存在浏览器localStorage中
   - 定期更换API密钥
   - 设置IP白名单
   - 不要开启提币权限

2. **风险控制**
   - 先在测试网充分测试
   - 从小仓位开始实盘
   - 设置合理的止损
   - 不要使用全部资金

3. **监控策略**
   - 定期查看交易记录
   - 观察策略表现
   - 及时调整参数
   - 遇到异常立即停止

4. **技术风险**
   - 网络连接不稳定可能导致信号丢失
   - 币安API限制可能导致请求失败
   - 极端行情可能触发大量止损
   - 建议保持稳定网络环境

## 常见问题

### Q: 为什么没有真实下单？
A: 请检查是否勾选了"测试模式"。测试模式下不会真实下单，仅模拟交易。

### Q: 如何知道策略是否有效？
A: 建议先在"策略回测"标签页使用模拟数据进行回测，观察历史表现。

### Q: 可以同时监控多个合约吗？
A: 可以，系统支持同时监控多个合约，会独立计算每个合约的交易信号。

### Q: API密钥安全吗？
A: API密钥存储在浏览器本地，不会发送到外部服务器。但建议定期更换，并设置IP白名单。

### Q: 如何停止自动交易？
A: 点击"停止监控"按钮即可停止，或者取消勾选"自动交易"停止自动下单。

## 技术架构

- **前端框架**: Next.js 16 (App Router)
- **UI框架**: React 19 + Tailwind CSS 4
- **数据可视化**: Lightweight Charts
- **币安API**: 币安期货REST API + WebSocket
- **语言**: TypeScript 5

## 免责声明

⚠️ **重要声明：**

1. 本系统仅供学习和研究使用，不构成投资建议。
2. 数字货币交易存在高风险，可能导致资金全部损失。
3. 使用本系统进行交易的所有后果由使用者自行承担。
4. 策略历史表现不代表未来收益。
5. 请在充分了解风险的前提下谨慎使用。

## 开源协议

MIT License

---

如有问题或建议，欢迎反馈！
